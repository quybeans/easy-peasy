{"version":3,"file":"index.iife.js","sources":["../src/context.js","../src/hooks.js","../src/constants.js","../src/helpers.js","../src/lib.js","../src/create-reducer.js","../src/persistence.js","../src/actions.js","../src/thunks.js","../src/alias.js","../src/listeners.js","../src/computed-properties.js","../src/effects.js","../src/extract-data-from-model.js","../src/proxy-store.js","../src/create-store.js","../src/create-context-store.js","../src/create-transform.js","../src/provider.js","../src/use-local-store.js"],"sourcesContent":["import { createContext } from 'react';\n\nconst StoreContext = createContext();\n\nexport default StoreContext;\n","import {\n  useContext,\n  useEffect,\n  useLayoutEffect,\n  useReducer,\n  useRef,\n  useState,\n} from 'react';\nimport EasyPeasyContext from './context';\n\n// React currently throws a warning when using useLayoutEffect on the server.\n// To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser. We need useLayoutEffect to ensure the store\n// subscription callback always has the selector from the latest render commit\n// available, otherwise a store update may happen between render and the effect,\n// which may cause missed updates; we also must ensure the store subscription\n// is created synchronously, otherwise a store update may occur before the\n// subscription is created and an inconsistent state may be observed\nconst useIsomorphicLayoutEffect =\n  typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n\nexport function createStoreStateHook(Context) {\n  return function useStoreState(mapState, equalityFn) {\n    const store = useContext(Context);\n    const mapStateRef = useRef(mapState);\n    const stateRef = useRef();\n    const mountedRef = useRef(true);\n    const subscriptionMapStateError = useRef();\n\n    const [, forceRender] = useReducer((s) => s + 1, 0);\n\n    if (\n      subscriptionMapStateError.current ||\n      mapStateRef.current !== mapState ||\n      stateRef.current === undefined\n    ) {\n      try {\n        stateRef.current = mapState(store.getState());\n      } catch (err) {\n        if (process.env.NODE_ENV === 'development') {\n          let errorMessage = `Error in useStoreState: ${err.message}.`;\n          if (subscriptionMapStateError.current) {\n            errorMessage += `\\nMaybe related to:\\n${subscriptionMapStateError.current.stack}`;\n          }\n          throw new Error(errorMessage);\n        }\n        throw subscriptionMapStateError.current || err;\n      }\n    }\n\n    useIsomorphicLayoutEffect(() => {\n      mapStateRef.current = mapState;\n      subscriptionMapStateError.current = undefined;\n    });\n\n    useIsomorphicLayoutEffect(() => {\n      const checkMapState = () => {\n        try {\n          const newState = mapStateRef.current(store.getState());\n\n          const isStateEqual =\n            typeof equalityFn === 'function'\n              ? equalityFn(stateRef.current, newState)\n              : stateRef.current === newState;\n\n          if (isStateEqual) {\n            return;\n          }\n\n          stateRef.current = newState;\n        } catch (err) {\n          // see https://github.com/reduxjs/react-redux/issues/1179\n          // There is a possibility mapState will fail due to stale state or\n          // props, therefore we will just track the error and force our\n          // component to update. It should then receive the updated state\n          subscriptionMapStateError.current = err;\n        }\n        if (mountedRef.current) {\n          forceRender({});\n        }\n      };\n      const unsubscribe = store.subscribe(checkMapState);\n      checkMapState();\n      return () => {\n        mountedRef.current = false;\n        unsubscribe();\n      };\n    }, []);\n\n    return stateRef.current;\n  };\n}\n\nexport const useStoreState = createStoreStateHook(EasyPeasyContext);\n\nexport function createStoreActionsHook(Context) {\n  return function useStoreActions(mapActions) {\n    const store = useContext(Context);\n    return mapActions(store.getActions());\n  };\n}\n\nexport const useStoreActions = createStoreActionsHook(EasyPeasyContext);\n\nexport function createStoreDispatchHook(Context) {\n  return function useStoreDispatch() {\n    const store = useContext(Context);\n    return store.dispatch;\n  };\n}\n\nexport const useStoreDispatch = createStoreDispatchHook(EasyPeasyContext);\n\nexport function useStore() {\n  return useContext(EasyPeasyContext);\n}\n\nexport function createStoreRehydratedHook(Context) {\n  return function useStoreRehydrated() {\n    const store = useContext(Context);\n    const [rehydrated, setRehydrated] = useState(false);\n    useEffect(() => {\n      store.persist.resolveRehydration().then(() => setRehydrated(true));\n    }, []);\n    return rehydrated;\n  };\n}\n\nexport const useStoreRehydrated = createStoreRehydratedHook(EasyPeasyContext);\n\nexport function createTypedHooks() {\n  return {\n    useStoreActions,\n    useStoreDispatch,\n    useStoreState,\n    useStoreRehydrated,\n    useStore,\n  };\n}\n","export const actionSymbol = '$_a';\nexport const actionOnSymbol = '$_aO';\nexport const computedSymbol = '$_c';\nexport const effectOnSymbol = '$_e';\nexport const persistSymbol = '$_p';\nexport const reducerSymbol = '$_r';\nexport const thunkOnSymbol = '$_tO';\nexport const thunkSymbol = '$_t';\nexport const aliasSymbol = '$_alias';\n","import { isDraft, current } from 'immer';\nimport {\n  actionOnSymbol,\n  actionSymbol,\n  computedSymbol,\n  effectOnSymbol,\n  persistSymbol,\n  reducerSymbol,\n  thunkOnSymbol,\n  thunkSymbol,\n  aliasSymbol,\n} from './constants';\n\nexport const debug = (state) => {\n  if (isDraft(state)) {\n    return current(state);\n  }\n  return state;\n};\n\nexport const actionOn = (targetResolver, fn) => ({\n  [actionOnSymbol]: true,\n  fn,\n  targetResolver,\n});\n\nexport const action = (fn) => ({\n  [actionSymbol]: true,\n  fn,\n});\n\nconst defaultStateResolvers = [(state) => state];\n\nexport const computed = (fnOrStateResolvers, fn) => {\n  if (typeof fn === 'function') {\n    return {\n      [computedSymbol]: true,\n      fn,\n      stateResolvers: fnOrStateResolvers,\n    };\n  }\n  return {\n    [computedSymbol]: true,\n    fn: fnOrStateResolvers,\n    stateResolvers: defaultStateResolvers,\n  };\n};\n\nexport function unstable_effectOn(dependencyResolvers, fn) {\n  return {\n    [effectOnSymbol]: true,\n    dependencyResolvers,\n    fn,\n  };\n}\n\nexport function generic(value) {\n  return value;\n}\n\nexport const persist = (model, config) =>\n  // if we are not running in a browser context this becomes a no-op\n  typeof window === 'undefined'\n    ? model\n    : {\n        ...model,\n        [persistSymbol]: config,\n      };\n\nexport const thunkOn = (targetResolver, fn) => ({\n  [thunkOnSymbol]: true,\n  fn,\n  targetResolver,\n});\n\nexport const thunk = (fn) => ({\n  [thunkSymbol]: true,\n  fn,\n});\n\nexport const alias = (fn) => ({\n  [aliasSymbol]: true,\n  fn,\n});\n\nexport const reducer = (fn) => ({\n  [reducerSymbol]: true,\n  fn,\n});\n","import React from 'react';\nimport { Immer, isDraft } from 'immer';\n\n/**\n * We create our own immer instance to avoid potential issues with autoFreeze\n * becoming default enabled everywhere. We want to disable autofreeze as it\n * does not suit the design of Easy Peasy.\n * https://github.com/immerjs/immer/issues/681#issuecomment-705581111\n */\nlet easyPeasyImmer;\n\nexport function isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n\n  let proto = obj;\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n}\n\nexport function clone(source) {\n  function recursiveClone(current) {\n    const next = Object.keys(current).reduce((acc, key) => {\n      if (Object.getOwnPropertyDescriptor(current, key).get == null) {\n        acc[key] = current[key];\n      }\n      return acc;\n    }, {});\n    Object.keys(next).forEach((key) => {\n      if (isPlainObject(next[key])) {\n        next[key] = recursiveClone(next[key]);\n      }\n    });\n    return next;\n  }\n  return recursiveClone(source);\n}\n\nexport function isPromise(x) {\n  return x != null && typeof x === 'object' && typeof x.then === 'function';\n}\n\nexport function get(path, target) {\n  return path.reduce(\n    (acc, cur) => (isPlainObject(acc) ? acc[cur] : undefined),\n    target,\n  );\n}\n\nexport function newify(currentPath, currentState, finalValue) {\n  if (currentPath.length === 0) {\n    return finalValue;\n  }\n  const newState = { ...currentState };\n  const key = currentPath[0];\n  if (currentPath.length === 1) {\n    newState[key] = finalValue;\n  } else {\n    newState[key] = newify(currentPath.slice(1), newState[key], finalValue);\n  }\n  return newState;\n}\n\nexport function set(path, target, value) {\n  if (path.length === 0) {\n    if (typeof value === 'object') {\n      Object.keys(target).forEach((key) => {\n        delete target[key];\n      });\n      Object.keys(value).forEach((key) => {\n        target[key] = value[key];\n      });\n    }\n    return;\n  }\n  path.reduce((acc, cur, idx) => {\n    if (idx + 1 === path.length) {\n      acc[cur] = value;\n    } else {\n      acc[cur] = acc[cur] || {};\n    }\n    return acc[cur];\n  }, target);\n}\n\nexport function createSimpleProduce(disableImmer = false) {\n  return function simpleProduce(path, state, fn) {\n    if (disableImmer) {\n      const current = get(path, state);\n      const next = fn(current);\n      if (current !== next) {\n        return newify(path, state, next);\n      }\n      return state;\n    }\n    if (!easyPeasyImmer) {\n      easyPeasyImmer = new Immer({\n        // We need to ensure that we disable proxies if they aren't available\n        // on the environment. Users need to ensure that they use the enableES5\n        // feature of immer.\n        useProxies:\n          typeof Proxy !== 'undefined' &&\n          typeof Proxy.revocable !== 'undefined' &&\n          typeof Reflect !== 'undefined',\n        // Autofreezing breaks easy-peasy, we need a mixed version of immutability\n        // and mutability in order to apply updates to our computed properties\n        autoFreeze: false,\n      });\n    }\n    if (path.length === 0) {\n      const draft = easyPeasyImmer.createDraft(state);\n      const result = fn(draft);\n      if (result) {\n        return isDraft(result) ? easyPeasyImmer.finishDraft(result) : result;\n      }\n      return easyPeasyImmer.finishDraft(draft);\n    }\n    const parentPath = path.slice(0, path.length - 1);\n    const draft = easyPeasyImmer.createDraft(state);\n    const parent = get(parentPath, state);\n    const current = get(path, draft);\n    const result = fn(current);\n\n    if (result) {\n      parent[path[path.length - 1]] = result;\n    }\n    return easyPeasyImmer.finishDraft(draft);\n  };\n}\n\nconst pReduce = (iterable, reducer, initialValue) =>\n  new Promise((resolve, reject) => {\n    const iterator = iterable[Symbol.iterator]();\n    let index = 0;\n\n    const next = (total) => {\n      const element = iterator.next();\n\n      if (element.done) {\n        resolve(total);\n        return;\n      }\n\n      Promise.all([total, element.value])\n        .then((value) =>\n          // eslint-disable-next-line no-plusplus\n          next(reducer(value[0], value[1], index++)),\n        )\n        .catch((err) => reject(err));\n    };\n\n    next(initialValue);\n  });\n\nexport const pSeries = (tasks) => {\n  const results = [];\n  return pReduce(tasks, (_, task) =>\n    task().then((value) => {\n      results.push(value);\n    }),\n  ).then(() => results);\n};\n\nexport function areInputsEqual(newInputs, lastInputs) {\n  if (newInputs.length !== lastInputs.length) {\n    return false;\n  }\n  for (let i = 0; i < newInputs.length; i += 1) {\n    if (newInputs[i] !== lastInputs[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n// export function memoizeOne(resultFn) {\n//   let lastArgs = [];\n//   let lastResult;\n//   let calledOnce = false;\n\n//   return function memoized(...args) {\n//     if (calledOnce && areInputsEqual(args, lastArgs)) {\n//       return lastResult;\n//     }\n//     lastResult = resultFn(...args);\n//     calledOnce = true;\n//     lastArgs = args;\n//     return lastResult;\n//   };\n// }\n\nexport function useMemoOne(\n  // getResult changes on every call,\n  getResult,\n  // the inputs array changes on every call\n  inputs,\n) {\n  // using useState to generate initial value as it is lazy\n  const initial = React.useState(() => ({\n    inputs,\n    result: getResult(),\n  }))[0];\n\n  const committed = React.useRef(initial);\n\n  // persist any uncommitted changes after they have been committed\n\n  const isInputMatch = Boolean(\n    inputs &&\n      committed.current.inputs &&\n      areInputsEqual(inputs, committed.current.inputs),\n  );\n\n  // create a new cache if required\n  const cache = isInputMatch\n    ? committed.current\n    : {\n        inputs,\n        result: getResult(),\n      };\n\n  // commit the cache\n  React.useEffect(() => {\n    committed.current = cache;\n  }, [cache]);\n\n  return cache.result;\n}\n","import { isDraft, original } from 'immer';\nimport { createSimpleProduce, get } from './lib';\n\nexport default function createReducer(disableImmer, _aRD, _cR, _cP) {\n  const simpleProduce = createSimpleProduce(disableImmer);\n\n  const runActionReducerAtPath = (state, action, actionReducer, path) =>\n    simpleProduce(path, state, (draft) => actionReducer(draft, action.payload));\n\n  const reducerForActions = (state, action) => {\n    const actionReducer = _aRD[action.type];\n    if (actionReducer) {\n      return runActionReducerAtPath(\n        state,\n        action,\n        actionReducer,\n        actionReducer.def.meta.parent,\n      );\n    }\n    return state;\n  };\n\n  const reducerForCustomReducers = (state, action) =>\n    _cR.reduce(\n      (acc, { parentPath, key, reducer }) =>\n        simpleProduce(parentPath, acc, (draft) => {\n          draft[key] = reducer(\n            isDraft(draft[key]) ? original(draft[key]) : draft[key],\n            action,\n          );\n          return draft;\n        }),\n      state,\n    );\n\n  const rootReducer = (state, action) => {\n    const stateAfterActions = reducerForActions(state, action);\n    const next =\n      _cR.length > 0\n        ? reducerForCustomReducers(stateAfterActions, action)\n        : stateAfterActions;\n    if (state !== next) {\n      _cP.forEach(({ parentPath, bindComputedProperty }) => {\n        const parentState = get(parentPath, next);\n        if (parentState != null) bindComputedProperty(parentState, next);\n      });\n    }\n    return next;\n  };\n\n  return rootReducer;\n}\n","import { clone, get, isPlainObject, isPromise, set, pSeries } from './lib';\n\nconst noopStorage = {\n  getItem: () => undefined,\n  setItem: () => undefined,\n  removeItem: () => undefined,\n};\n\nconst getBrowerStorage = (storageName) => {\n  let storageCache;\n  return () => {\n    if (!storageCache) {\n      try {\n        if (\n          typeof window !== 'undefined' &&\n          typeof window[storageName] !== 'undefined'\n        ) {\n          storageCache = window[storageName];\n        }\n      } catch (_) {\n        // swallow the failure\n      }\n      if (!storageCache) {\n        storageCache = noopStorage;\n      }\n    }\n\n    return storageCache;\n  };\n};\n\nconst localStorage = getBrowerStorage('localStorage');\nconst sessionStorage = getBrowerStorage('sessionStorage');\n\nfunction createStorageWrapper(storage, transformers = []) {\n  if (storage == null) {\n    storage = sessionStorage();\n  }\n\n  if (typeof storage === 'string') {\n    if (storage === 'localStorage') {\n      storage = localStorage();\n    } else if (storage === 'sessionStorage') {\n      storage = sessionStorage();\n    } else {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn(`Invalid storage provider`);\n      }\n      storage = noopStorage;\n    }\n  }\n\n  const outTransformers = [...transformers].reverse();\n\n  const serialize = (data) => {\n    if (transformers.length > 0 && data != null && typeof data === 'object') {\n      Object.keys(data).forEach((key) => {\n        data[key] = transformers.reduce(\n          (acc, cur) => cur.in(acc, key),\n          data[key],\n        );\n      });\n    }\n\n    return storage === localStorage() || storage === sessionStorage()\n      ? JSON.stringify({ data })\n      : data;\n  };\n\n  const deserialize = (data) => {\n    const result =\n      storage === localStorage() || storage === sessionStorage()\n        ? JSON.parse(data).data\n        : data;\n    if (\n      outTransformers.length > 0 &&\n      result != null &&\n      typeof result === 'object'\n    ) {\n      Object.keys(result).forEach((key) => {\n        result[key] = outTransformers.reduce(\n          (acc, cur) => cur.out(acc, key),\n          result[key],\n        );\n      });\n    }\n    return result;\n  };\n\n  const isAsync = isPromise(storage.getItem('_'));\n\n  return {\n    getItem: (key) => {\n      if (isAsync) {\n        return storage\n          .getItem(key)\n          .then((wrapped) =>\n            wrapped != null ? deserialize(wrapped) : undefined,\n          );\n      }\n      const wrapped = storage.getItem(key);\n      return wrapped != null ? deserialize(wrapped) : undefined;\n    },\n    setItem: (key, data) => storage.setItem(key, serialize(data)),\n    removeItem: (key) => storage.removeItem(key),\n  };\n}\n\nexport function extractPersistConfig(path, persistdef = {}) {\n  return {\n    path,\n    config: {\n      allow: persistdef.allow || [],\n      deny: persistdef.deny || [],\n      mergeStrategy: persistdef.mergeStrategy || 'mergeDeep',\n      storage: createStorageWrapper(\n        persistdef.storage,\n        persistdef.transformers,\n      ),\n    },\n  };\n}\n\nfunction resolvePersistTargets(target, allow, deny) {\n  let targets = Object.keys(target);\n  if (allow.length > 0) {\n    targets = targets.reduce((acc, cur) => {\n      if (allow.findIndex((x) => x === cur) !== -1) {\n        return [...acc, cur];\n      }\n      return acc;\n    }, []);\n  }\n  if (deny.length > 0) {\n    targets = targets.reduce((acc, cur) => {\n      if (deny.findIndex((x) => x === cur) !== -1) {\n        return acc;\n      }\n      return [...acc, cur];\n    }, []);\n  }\n  return targets;\n}\n\nfunction createPersistenceClearer(persistKey, _r) {\n  return () => {\n    if (_r._i._persistenceConfig.length === 0) {\n      return Promise.resolve();\n    }\n    return pSeries(\n      _r._i._persistenceConfig.map(({ path, config }) => () =>\n        Promise.resolve(config.storage.removeItem(persistKey(path))),\n      ),\n    );\n  };\n}\n\nexport function createPersistor(persistKey, _r) {\n  let persistPromise = Promise.resolve();\n  let isPersisting = false;\n  let nextPersistOperation;\n\n  const timingMethod =\n    typeof window === 'undefined'\n      ? (fn) => fn()\n      : window.requestIdleCallback != null\n      ? window.requestIdleCallback\n      : window.requestAnimationFrame;\n\n  const persist = (nextState) => {\n    if (_r._i._persistenceConfig.length === 0) {\n      return;\n    }\n\n    const operation = () => {\n      isPersisting = true;\n      persistPromise = new Promise((resolve) => {\n        timingMethod(() => {\n          pSeries(\n            _r._i._persistenceConfig.map(({ path, config }) => () => {\n              const { storage, allow, deny } = config;\n              const persistRootState = clone(get(path, nextState));\n              const persistTargets = resolvePersistTargets(\n                persistRootState,\n                allow,\n                deny,\n              );\n              const stateToPersist = {};\n              persistTargets.map((key) => {\n                const targetPath = [...path, key];\n                const rawValue = get(targetPath, nextState);\n                const value = isPlainObject(rawValue)\n                  ? clone(rawValue)\n                  : rawValue;\n                stateToPersist[key] = value;\n              });\n              return Promise.resolve(\n                storage.setItem(persistKey(path), stateToPersist),\n              );\n            }),\n          ).finally(() => {\n            isPersisting = false;\n            if (nextPersistOperation) {\n              const next = nextPersistOperation;\n              nextPersistOperation = null;\n              next();\n            } else {\n              resolve();\n            }\n          });\n        });\n      });\n    };\n\n    if (isPersisting) {\n      nextPersistOperation = operation;\n    } else {\n      operation();\n    }\n  };\n\n  return {\n    persist,\n    clear: createPersistenceClearer(persistKey, _r),\n    flush: () => {\n      if (nextPersistOperation) {\n        nextPersistOperation();\n      }\n      return persistPromise;\n    },\n  };\n}\n\nexport function createPersistMiddleware(persistor, _r) {\n  return ({ getState }) => (next) => (action) => {\n    const state = next(action);\n    if (\n      action &&\n      action.type !== '@action.ePRS' &&\n      _r._i._persistenceConfig.length > 0\n    ) {\n      persistor.persist(getState());\n    }\n    return state;\n  };\n}\n\nexport function rehydrateStateFromPersistIfNeeded(\n  persistKey,\n  replaceState,\n  _r,\n  root,\n) {\n  if (_r._i._persistenceConfig.length === 0) {\n    return Promise.resolve();\n  }\n\n  const state = clone(_r._i._dS);\n\n  let rehydrating = false;\n\n  return pSeries(\n    _r._i._persistenceConfig.map((persistInstance) => () => {\n      const { path, config } = persistInstance;\n      const { mergeStrategy, storage } = config;\n\n      if (root && (path.length < 1 || path[0] !== root)) {\n        return Promise.resolve();\n      }\n\n      const hasDataModelChanged = (dataModel, rehydratingModelData) =>\n        dataModel != null &&\n        rehydratingModelData != null &&\n        (typeof dataModel !== typeof rehydratingModelData ||\n          (Array.isArray(dataModel) && !Array.isArray(rehydratingModelData)));\n\n      const applyRehydrationStrategy = (persistedState) => {\n        if (mergeStrategy === 'overwrite') {\n          set(path, state, persistedState);\n        } else if (mergeStrategy === 'mergeShallow') {\n          const targetState = get(path, state);\n          Object.keys(persistedState).forEach((key) => {\n            if (hasDataModelChanged(targetState[key], persistedState[key])) {\n              // skip as the data model type has changed since the data was persisted\n            } else {\n              targetState[key] = persistedState[key];\n            }\n          });\n        } else if (mergeStrategy === 'mergeDeep') {\n          const targetState = get(path, state);\n          const setAt = (currentTargetState, currentPersistedState) => {\n            Object.keys(currentPersistedState).forEach((key) => {\n              if (\n                hasDataModelChanged(\n                  currentTargetState[key],\n                  currentPersistedState[key],\n                )\n              ) {\n                // skip as the data model type has changed since the data was persisted\n              } else if (isPlainObject(currentPersistedState[key])) {\n                currentTargetState[key] = currentTargetState[key] || {};\n                setAt(currentTargetState[key], currentPersistedState[key]);\n              } else {\n                currentTargetState[key] = currentPersistedState[key];\n              }\n            });\n          };\n          setAt(targetState, persistedState);\n        }\n      };\n\n      const rehydate = (persistedState) => {\n        if (persistedState != null) {\n          applyRehydrationStrategy(persistedState);\n          rehydrating = true;\n        }\n      };\n\n      const getItemResult = storage.getItem(persistKey(path));\n      if (isPromise(getItemResult)) {\n        return getItemResult.then(rehydate);\n      }\n      return Promise.resolve(rehydate(getItemResult));\n    }),\n  ).then(() => {\n    if (rehydrating) {\n      replaceState(state);\n    }\n  });\n}\n","import { actionOnSymbol } from './constants';\n\nexport function createActionCreator(def, _r) {\n  function actionCreator(payload) {\n    const action = {\n      type: def.meta.type,\n      payload,\n    };\n    if (def[actionOnSymbol] && def.meta.resolvedTargets) {\n      payload.resolvedTargets = [...def.meta.resolvedTargets];\n    }\n    return _r.dispatch(action);\n  }\n\n  // We bind the types to the creator for easy reference by consumers\n  actionCreator.type = def.meta.type;\n\n  return actionCreator;\n}\n","import { thunkOnSymbol } from './constants';\nimport { get, isPromise } from './lib';\n\nexport function createThunkHandler(def, _r, injections, _aC) {\n  return (payload, fail) => {\n    const helpers = {\n      dispatch: _r.dispatch,\n      fail,\n      getState: () => get(def.meta.parent, _r.getState()),\n      getStoreActions: () => _aC,\n      getStoreState: _r.getState,\n      injections,\n      meta: {\n        key: def.meta.actionName,\n        parent: def.meta.parent,\n        path: def.meta.path,\n      },\n    };\n    if (def[thunkOnSymbol] && def.meta.resolvedTargets) {\n      payload.resolvedTargets = [...def.meta.resolvedTargets];\n    }\n    return def.fn(get(def.meta.parent, _aC), payload, helpers);\n  };\n}\n\nconst logThunkEventListenerError = (type, err) => {\n  // eslint-disable-next-line no-console\n  console.log(`Error in ${type}`);\n  // eslint-disable-next-line no-console\n  console.log(err);\n};\n\nconst handleEventDispatchErrors = (type, dispatcher) => (...args) => {\n  try {\n    const result = dispatcher(...args);\n    if (isPromise(result)) {\n      result.catch((err) => {\n        logThunkEventListenerError(type, err);\n      });\n    }\n  } catch (err) {\n    logThunkEventListenerError(type, err);\n  }\n};\n\nexport function createThunkActionsCreator(def, _r) {\n  const actionCreator = (payload) => {\n    const dispatchStart = handleEventDispatchErrors(def.meta.startType, () =>\n      _r.dispatch({\n        type: def.meta.startType,\n        payload,\n      }),\n    );\n\n    const dispatchFail = handleEventDispatchErrors(def.meta.failType, (err) =>\n      _r.dispatch({\n        type: def.meta.failType,\n        payload,\n        error: err,\n      }),\n    );\n\n    const dispatchSuccess = handleEventDispatchErrors(\n      def.meta.successType,\n      (result) =>\n        _r.dispatch({\n          type: def.meta.successType,\n          payload,\n          result,\n        }),\n    );\n\n    dispatchStart();\n\n    let failure = null;\n\n    const fail = (_failure) => {\n      failure = _failure;\n    };\n\n    const result = _r.dispatch(() => def.thunkHandler(payload, fail));\n\n    if (isPromise(result)) {\n      return result.then((resolved) => {\n        if (failure) {\n          dispatchFail(failure);\n        } else {\n          dispatchSuccess(resolved);\n        }\n        return resolved;\n      });\n    }\n\n    if (failure) {\n      dispatchFail(failure);\n    } else {\n      dispatchSuccess(result);\n    }\n\n    return result;\n  };\n\n  actionCreator.type = def.meta.type;\n  actionCreator.successType = def.meta.successType;\n  actionCreator.failType = def.meta.failType;\n  actionCreator.startType = def.meta.startType;\n\n  return actionCreator;\n}\n","import { get, isPromise } from './lib';\n\nfunction createThunkHandler(def, _r, injections, _aC) {\n  return (payload, fail) => {\n    const helpers = {\n      dispatch: _r.dispatch,\n      fail,\n      getState: () => get(def.meta.parent, _r.getState()),\n      getStoreActions: () => _aC,\n      getStoreState: _r.getState,\n      injections,\n      meta: {\n        key: def.meta.actionName,\n        parent: def.meta.parent,\n        path: def.meta.path,\n      },\n    };\n    if (def[thunkOnSymbol] && def.meta.resolvedTargets) {\n      payload.resolvedTargets = [...def.meta.resolvedTargets];\n    }\n    return def.fn(get(def.meta.parent, _aC), payload, helpers);\n  };\n}\n\nconst logThunkEventListenerError = (type, err) => {\n  // eslint-disable-next-line no-console\n  console.log(`Error in ${type}`);\n  // eslint-disable-next-line no-console\n  console.log(err);\n};\n\nconst handleEventDispatchErrors = (type, dispatcher) => (...args) => {\n  try {\n    const result = dispatcher(...args);\n    if (isPromise(result)) {\n      result.catch((err) => {\n        logThunkEventListenerError(type, err);\n      });\n    }\n  } catch (err) {\n    logThunkEventListenerError(type, err);\n  }\n};\n\nexport function createAliasActionsCreator(def, _r, isProxyStore) {\n  const actionCreator = (payload) => {\n    const dispatchStart = handleEventDispatchErrors(def.meta.startType, () =>\n      _r.dispatch({\n        type: def.meta.startType,\n        payload,\n      }),\n    );\n\n    const dispatchFail = handleEventDispatchErrors(def.meta.failType, (err) =>\n      _r.dispatch({\n        type: def.meta.failType,\n        payload,\n        error: err,\n      }),\n    );\n\n    const dispatchSuccess = handleEventDispatchErrors(\n      def.meta.successType,\n      (result) =>\n        _r.dispatch({\n          type: def.meta.successType,\n          payload,\n          result,\n        }),\n    );\n\n    if (!isProxyStore) {\n      dispatchStart();\n    }\n\n    let failure = null;\n\n    const fail = (_failure) => {\n      failure = _failure;\n    };\n\n    const result = _r.dispatch({ type: def.meta.type, payload: payload || {} });\n\n    if (isPromise(result)) {\n      return result.then((resolved) => {\n        if (failure) {\n          if (!isProxyStore) {\n            dispatchFail(failure);\n          }\n        } else {\n          if (!isProxyStore) {\n            dispatchSuccess(resolved);\n          }\n        }\n        return resolved;\n      });\n    }\n\n    if (failure) {\n      dispatchFail(failure);\n    } else {\n      dispatchSuccess(result);\n    }\n\n    return result;\n  };\n\n  actionCreator.type = def.meta.type;\n  actionCreator.successType = def.meta.successType;\n  actionCreator.failType = def.meta.failType;\n  actionCreator.startType = def.meta.startType;\n\n  return actionCreator;\n}\n\nexport const createAliasExecuterMiddleware = (_r) => () => (next) => (\n  action,\n) => {\n  if (typeof action.type === 'string') {\n    const pathArray = action.type.split('.');\n\n    if (pathArray[0] === '@alias') {\n      pathArray.shift();\n      const actions = _r._i._aC;\n      const aliasFunction = get(pathArray, actions);\n\n      if (aliasFunction) {\n        return new Promise((resolve, reject) => {\n          aliasFunction(action.payload)\n            .then((result) => {\n              action.payload = result;\n              resolve(next(action));\n              return;\n            })\n            .catch((error) => {\n              reject({ message: error });\n              return;\n            });\n        });\n      }\n    }\n  }\n\n  return next(action);\n};\n","import { get } from './lib';\n\nexport function createListenerMiddleware(_r) {\n  return () => (next) => (action) => {\n    const result = next(action);\n    if (\n      action &&\n      _r._i._lAM[action.type] &&\n      _r._i._lAM[action.type].length > 0\n    ) {\n      const sourceAction = _r._i._aCD[action.type];\n      _r._i._lAM[action.type].forEach((actionCreator) => {\n        actionCreator({\n          type: sourceAction ? sourceAction.def.meta.type : action.type,\n          payload: action.payload,\n          error: action.error,\n          result: action.result,\n        });\n      });\n    }\n    return result;\n  };\n}\n\nexport function bindListenerdefs(listenerdefs, _aC, _aCD, _lAM) {\n  listenerdefs.forEach((def) => {\n    const targets = def.targetResolver(get(def.meta.parent, _aC), _aC);\n\n    const targetTypes = (Array.isArray(targets) ? targets : [targets]).reduce(\n      (acc, target) => {\n        if (\n          typeof target === 'function' &&\n          target.def.meta.type &&\n          _aCD[target.def.meta.type]\n        ) {\n          if (target.def.meta.successType) {\n            acc.push(target.def.meta.successType);\n          } else {\n            acc.push(target.def.meta.type);\n          }\n        } else if (typeof target === 'string') {\n          acc.push(target);\n        }\n        return acc;\n      },\n      [],\n    );\n\n    def.meta.resolvedTargets = targetTypes;\n\n    targetTypes.forEach((targetType) => {\n      const listenerReg = _lAM[targetType] || [];\n      listenerReg.push(_aCD[def.meta.type]);\n      _lAM[targetType] = listenerReg;\n    });\n  });\n}\n","import { areInputsEqual } from './lib';\n\nexport function createComputedPropertyBinder(parentPath, key, def, _r) {\n  let runOnce = false;\n  let prevInputs = [];\n  let prevValue;\n  return function createComputedProperty(parentState, storeState) {\n    Object.defineProperty(parentState, key, {\n      configurable: true,\n      enumerable: true,\n      get: () => {\n        const inputs = def.stateResolvers.map((resolver) =>\n          resolver(parentState, storeState),\n        );\n        if (\n          runOnce &&\n          (areInputsEqual(prevInputs, inputs) ||\n            (_r._i._cS.isInReducer &&\n              new Error().stack.match(/shallowCopy/gi) !== null))\n        ) {\n          // We don't want computed properties resolved every time an action\n          // is handled by the reducer. They need to remain lazy, only being\n          // computed when used by a component or getState call.\n          return prevValue;\n        }\n        prevInputs = inputs;\n        prevValue = def.fn(...inputs);\n        runOnce = true;\n        return prevValue;\n      },\n    });\n  };\n}\n\nexport function createComputedPropertiesMiddleware(_r) {\n  return () => (next) => (action) => {\n    _r._i._cS.isInReducer = true;\n    const result = next(action);\n    _r._i._cS.isInReducer = false;\n    return result;\n  };\n}\n","import { get, isPromise } from './lib';\n\nexport function createEffectsMiddleware(_r) {\n  return (store) => (next) => (action) => {\n    if (_r._i._e.length === 0) {\n      return next(action);\n    }\n    const prevState = store.getState();\n    const result = next(action);\n    const nextState = store.getState();\n    _r._i._e.forEach((def) => {\n      const prevLocal = get(def.meta.parent, prevState);\n      const nextLocal = get(def.meta.parent, nextState);\n      if (prevLocal !== nextLocal) {\n        const prevDependencies = def.dependencyResolvers.map((resolver) =>\n          resolver(prevLocal),\n        );\n        const nextDependencies = def.dependencyResolvers.map((resolver) =>\n          resolver(nextLocal),\n        );\n        const hasChanged = prevDependencies.some(\n          (dependency, idx) => dependency !== nextDependencies[idx],\n        );\n        if (hasChanged) {\n          def.actionCreator(prevDependencies, nextDependencies, action);\n        }\n      }\n    });\n    return result;\n  };\n}\n\nconst logEffectError = (err) => {\n  // As users can't get a handle on effects we need to report the error\n  // eslint-disable-next-line no-console\n  console.log(err);\n};\n\nexport function createEffectHandler(def, _r, injections, _aC) {\n  const actions = get(def.meta.parent, _aC);\n\n  let dispose;\n\n  return (change) => {\n    const helpers = {\n      dispatch: _r.dispatch,\n      getState: () => get(def.meta.parent, _r.getState()),\n      getStoreActions: () => _aC,\n      getStoreState: _r.getState,\n      injections,\n      meta: {\n        key: def.meta.actionName,\n        parent: def.meta.parent,\n        path: def.meta.path,\n      },\n    };\n\n    if (dispose !== undefined) {\n      const disposeResult = dispose();\n      dispose = undefined;\n      if (isPromise(disposeResult)) {\n        disposeResult.catch(logEffectError);\n      }\n    }\n\n    const effectResult = def.fn(actions, change, helpers);\n\n    if (isPromise(effectResult)) {\n      return effectResult.then((resolved) => {\n        if (typeof resolved === 'function') {\n          if (process.env.NODE_ENV !== 'production') {\n            // Dispose functions are not allowed to be resolved asynchronously.\n            // Doing so would provide inconsistent behaviour around their execution.\n            // eslint-disable-next-line no-console\n            console.warn(\n              '[easy-peasy] Effect is asynchronously resolving a dispose fn.',\n            );\n          }\n        }\n      });\n    }\n\n    if (typeof effectResult === 'function') {\n      dispose = effectResult;\n    }\n\n    return undefined;\n  };\n}\n\nconst logEffectEventListenerError = (type, err) => {\n  // eslint-disable-next-line no-console\n  console.log(`Error in ${type}`);\n  // eslint-disable-next-line no-console\n  console.log(err);\n};\n\nconst handleEventDispatchErrors = (type, dispatcher) => (...args) => {\n  try {\n    const result = dispatcher(...args);\n    if (isPromise(result)) {\n      result.catch((err) => {\n        logEffectEventListenerError(type, err);\n      });\n    }\n  } catch (err) {\n    logEffectEventListenerError(type, err);\n  }\n};\n\nexport function createEffectActionsCreator(def, _r, effectHandler) {\n  const actionCreator = (previousDependencies, nextDependencies, action) => {\n    const change = {\n      prev: previousDependencies,\n      current: nextDependencies,\n      action,\n    };\n\n    const dispatchStart = handleEventDispatchErrors(def.meta.startType, () =>\n      _r.dispatch({\n        type: def.meta.startType,\n        change,\n      }),\n    );\n\n    const dispatchSuccess = handleEventDispatchErrors(\n      def.meta.successType,\n      () =>\n        _r.dispatch({\n          type: def.meta.successType,\n          change,\n        }),\n    );\n\n    dispatchStart();\n\n    try {\n      const result = _r.dispatch(() => effectHandler(change));\n\n      if (isPromise(result)) {\n        return result.then((resolved) => {\n          dispatchSuccess(resolved);\n          return resolved;\n        }, logEffectError);\n      }\n\n      dispatchSuccess(result);\n\n      return result;\n    } catch (err) {\n      logEffectError(err);\n    }\n  };\n\n  actionCreator.type = def.meta.type;\n  actionCreator.startType = def.meta.startType;\n  actionCreator.successType = def.meta.successType;\n  actionCreator.failType = def.meta.failType;\n\n  return actionCreator;\n}\n","import {\n  aliasSymbol,\n  actionOnSymbol,\n  actionSymbol,\n  computedSymbol,\n  effectOnSymbol,\n  persistSymbol,\n  reducerSymbol,\n  thunkOnSymbol,\n  thunkSymbol,\n} from './constants';\nimport { get, isPlainObject, set } from './lib';\nimport { extractPersistConfig } from './persistence';\nimport { createActionCreator } from './actions';\nimport { createThunkHandler, createThunkActionsCreator } from './thunks';\nimport { createAliasHandler, createAliasActionsCreator } from './alias';\nimport { bindListenerdefs } from './listeners';\nimport { createComputedPropertyBinder } from './computed-properties';\nimport { createEffectHandler, createEffectActionsCreator } from './effects';\n\nexport default function extractDataFromModel(\n  model,\n  initialState,\n  injections,\n  _r,\n  isProxyStore,\n) {\n  const _dS = initialState;\n  const _aCD = {};\n  const _aC = {};\n  const _aRD = {};\n  const actionThunks = {};\n  const _cP = [];\n  const _cR = [];\n  const _e = [];\n  const _lAC = {};\n  const _lAM = {};\n  const listenerdefs = [];\n  let _persistenceConfig = [];\n  const _cS = {\n    isInReducer: false,\n  };\n\n  const recursiveExtractFromModel = (current, parentPath) =>\n    Object.keys(current).forEach((key) => {\n      const value = current[key];\n      const path = [...parentPath, key];\n      const meta = {\n        parent: parentPath,\n        path,\n        key,\n      };\n      const handleValueAsState = () => {\n        const initialParentRef = get(parentPath, initialState);\n        if (initialParentRef && key in initialParentRef) {\n          set(path, _dS, initialParentRef[key]);\n        } else {\n          set(path, _dS, value);\n        }\n      };\n\n      if (key === persistSymbol) {\n        _persistenceConfig.push(extractPersistConfig(parentPath, value));\n        return;\n      }\n\n      if (value != null && typeof value === 'object') {\n        if (value[actionSymbol] || value[actionOnSymbol]) {\n          const def = { ...value };\n\n          // Determine the category of the action\n          const category = def[actionSymbol] ? '@action' : '@actionOn';\n\n          // Establish the meta data describing the action\n          def.meta = {\n            actionName: meta.key,\n            category,\n            type: `${category}.${meta.path.join('.')}`,\n            parent: meta.parent,\n            path: meta.path,\n          };\n\n          // Create the \"action creator\" function\n          def.actionCreator = createActionCreator(def, _r);\n\n          // Create a bidirectional relationship of the def/actionCreator\n          def.actionCreator.def = def;\n\n          // Create a bidirectional relationship of the def/reducer\n          def.fn.def = def;\n\n          // Add the action creator to lookup map\n          _aCD[def.meta.type] = def.actionCreator;\n\n          // Add the reducer to lookup map\n          _aRD[def.meta.type] = def.fn;\n\n          // We don't want to expose the internal action to consumers\n          if (meta.key !== 'ePRS') {\n            // Set the action creator in the \"actions\" object tree for\n            // either the listeners object tree, or the standard actions/thunks\n            // object tree\n            if (def[actionOnSymbol]) {\n              listenerdefs.push(def);\n              set(path, _lAC, def.actionCreator);\n            } else {\n              set(path, _aC, def.actionCreator);\n            }\n          }\n        } else if (\n          value[thunkSymbol] ||\n          value[thunkOnSymbol] ||\n          value[aliasSymbol]\n        ) {\n          const def = { ...value };\n\n          // Determine the category of the thunk\n          let category = '@thunk';\n\n          if (def[thunkOnSymbol]) {\n            category = '@thunkOn';\n          } else if (def[aliasSymbol]) {\n            category = '@alias';\n          }\n\n          // Establish the meta data describing the thunk\n          const type = `${category}.${meta.path.join('.')}`;\n          def.meta = {\n            actionName: meta.key,\n            parent: meta.parent,\n            path: meta.path,\n            type,\n            startType: `${type}(start)`,\n            successType: `${type}(success)`,\n            failType: `${type}(fail)`,\n          };\n\n          // Create the function that will handle, i.e. be executed, when\n          // the thunk action is created/dispatched\n          def.thunkHandler = createThunkHandler(def, _r, injections, _aC);\n\n          // Register the thunk handler\n          set(path, actionThunks, def.thunkHandler);\n\n          // Create the \"action creator\" function\n          if (def[aliasSymbol]) {\n            def.actionCreator = createAliasActionsCreator(def, _r, isProxyStore);\n          } else {\n            def.actionCreator = createThunkActionsCreator(def, _r);\n          }\n\n          // Create a bidirectional relationship of the def/actionCreator\n          def.actionCreator.def = def;\n\n          // Register the action creator within the lookup map\n          _aCD[def.meta.type] = def.actionCreator;\n\n          // Set the action creator in the \"actions\" object tree for\n          // either the listeners object tree, or the standard actions/thunks\n          // object tree\n          if (def[thunkOnSymbol]) {\n            listenerdefs.push(def);\n            set(path, _lAC, def.actionCreator);\n          } else {\n            set(path, _aC, def.actionCreator);\n          }\n        } else if (value[computedSymbol]) {\n          const parent = get(parentPath, _dS);\n          const bindComputedProperty = createComputedPropertyBinder(\n            parentPath,\n            key,\n            value,\n            _r,\n          );\n          bindComputedProperty(parent, _dS);\n          _cP.push({ key, parentPath, bindComputedProperty });\n        } else if (value[reducerSymbol]) {\n          _cR.push({ key, parentPath, reducer: value.fn });\n        } else if (value[effectOnSymbol]) {\n          const def = { ...value };\n\n          // Establish the meta data describing the effect\n          const type = `@effectOn.${meta.path.join('.')}`;\n          def.meta = {\n            type,\n            actionName: meta.key,\n            parent: meta.parent,\n            path: meta.path,\n            startType: `${type}(start)`,\n            successType: `${type}(success)`,\n            failType: `${type}(fail)`,\n          };\n\n          const effectHandler = createEffectHandler(def, _r, injections, _aC);\n\n          const actionCreator = createEffectActionsCreator(\n            def,\n            _r,\n            effectHandler,\n          );\n\n          def.actionCreator = actionCreator;\n\n          _e.push(def);\n        } else if (isPlainObject(value)) {\n          const existing = get(path, _dS);\n          if (existing == null) {\n            set(path, _dS, {});\n          }\n          recursiveExtractFromModel(value, path);\n        } else {\n          handleValueAsState();\n        }\n      } else {\n        handleValueAsState();\n      }\n    });\n\n  _persistenceConfig = _persistenceConfig.sort((a, b) => {\n    const aPath = a.path.join('.');\n    const bPath = b.path.join('.');\n    if (aPath < bPath) {\n      return -1;\n    }\n    if (aPath > bPath) {\n      return 1;\n    }\n    return 0;\n  });\n\n  recursiveExtractFromModel(model, []);\n\n  bindListenerdefs(listenerdefs, _aC, _aCD, _lAM);\n\n  return {\n    _aCD,\n    _aC,\n    _aRD,\n    _cP,\n    _cR,\n    _cS,\n    _dS,\n    _e,\n    _lAC,\n    _lAM,\n    _persistenceConfig,\n  };\n}\n","import assignIn from 'lodash.assignin';\n\nimport {\n  DISPATCH_TYPE,\n  STATE_TYPE,\n  PATCH_STATE_TYPE,\n  DEFAULT_PORT_NAME,\n} from 'webext-redux/lib/constants';\nimport {\n  withSerializer,\n  withDeserializer,\n  noop,\n} from 'webext-redux/lib/serialization';\nimport shallowDiff from 'webext-redux/lib/strategies/shallowDiff/patch';\nimport { getBrowserAPI } from 'webext-redux/lib/util';\n\nconst backgroundErrPrefix =\n  '\\nLooks like there is an error in the background page. ' +\n  'You might want to inspect your background page for more details.\\n';\n\nconst defaultOpts = {\n  portName: DEFAULT_PORT_NAME,\n  state: {},\n  extensionId: null,\n  serializer: noop,\n  deserializer: noop,\n  patchStrategy: shallowDiff,\n};\n\nclass BackgroundError extends Error {\n  constructor(message) {\n    super();\n    this.name = 'BackgroundError';\n    this.message = message;\n  }\n}\n\nexport class ProxyStore {\n  /**\n   * Creates a new Proxy store\n   * @param  {object} options An object of form {portName, state, extensionId, serializer, deserializer, diffStrategy}, where `portName` is a required string and defines the name of the port for state transition changes, `state` is the initial state of this store (default `{}`) `extensionId` is the extension id as defined by browserAPI when extension is loaded (default `''`), `serializer` is a function to serialize outgoing message payloads (default is passthrough), `deserializer` is a function to deserialize incoming message payloads (default is passthrough), and patchStrategy is one of the included patching strategies (default is shallow diff) or a custom patching function.\n   */\n  constructor({\n    portName = defaultOpts.portName,\n    state = defaultOpts.state,\n    extensionId = defaultOpts.extensionId,\n    serializer = defaultOpts.serializer,\n    deserializer = defaultOpts.deserializer,\n    patchStrategy = defaultOpts.patchStrategy,\n  } = defaultOpts) {\n    if (!portName) {\n      throw new Error('portName is required in options');\n    }\n    if (typeof serializer !== 'function') {\n      throw new Error('serializer must be a function');\n    }\n    if (typeof deserializer !== 'function') {\n      throw new Error('deserializer must be a function');\n    }\n    if (typeof patchStrategy !== 'function') {\n      throw new Error(\n        'patchStrategy must be one of the included patching strategies or a custom patching function',\n      );\n    }\n\n    this.portName = portName;\n    this.readyResolved = false;\n    this.readyPromise = new Promise((resolve) => (this.readyResolve = resolve));\n\n    this.browserAPI = getBrowserAPI();\n    this.extensionId = extensionId; // keep the extensionId as an instance variable\n    this.port = this.browserAPI.runtime.connect(this.extensionId, {\n      name: portName,\n    });\n    this.safetyHandler = this.safetyHandler.bind(this);\n    if (this.browserAPI.runtime.onMessage) {\n      this.safetyMessage = this.browserAPI.runtime.onMessage.addListener(\n        this.safetyHandler,\n      );\n    }\n    this.serializedPortListener = withDeserializer(deserializer)((...args) =>\n      this.port.onMessage.addListener(...args),\n    );\n    this.serializedMessageSender = withSerializer(serializer)(\n      (...args) => this.browserAPI.runtime.sendMessage(...args),\n      1,\n    );\n    this.listeners = [];\n    this.state = state;\n    this.patchStrategy = patchStrategy;\n\n    // Don't use shouldDeserialize here, since no one else should be using this port\n    this.serializedPortListener((message) => {\n      switch (message.type) {\n        case STATE_TYPE:\n          this.replaceState(message.payload);\n\n          if (!this.readyResolved) {\n            this.readyResolved = true;\n            this.readyResolve();\n          }\n          break;\n\n        case PATCH_STATE_TYPE:\n          this.patchState(message.payload);\n          break;\n\n        default:\n        // do nothing\n      }\n    });\n\n    this.dispatch = this.dispatch.bind(this); // add this context to dispatch\n  }\n\n  /**\n   * Returns a promise that resolves when the store is ready. Optionally a callback may be passed in instead.\n   * @param [function] callback An optional callback that may be passed in and will fire when the store is ready.\n   * @return {object} promise A promise that resolves when the store has established a connection with the background page.\n   */\n  ready(cb = null) {\n    if (cb !== null) {\n      return this.readyPromise.then(cb);\n    }\n\n    return this.readyPromise;\n  }\n\n  /**\n   * Subscribes a listener function for all state changes\n   * @param  {function} listener A listener function to be called when store state changes\n   * @return {function}          An unsubscribe function which can be called to remove the listener from state updates\n   */\n  subscribe(listener) {\n    this.listeners.push(listener);\n\n    return () => {\n      this.listeners = this.listeners.filter((l) => l !== listener);\n    };\n  }\n\n  /**\n   * Replaces the state for only the keys in the updated state. Notifies all listeners of state change.\n   * @param {object} state the new (partial) redux state\n   */\n  patchState(difference) {\n    this.state = this.patchStrategy(this.state, difference);\n    this.listeners.forEach((l) => l());\n  }\n\n  /**\n   * Replace the current state with a new state. Notifies all listeners of state change.\n   * @param  {object} state The new state for the store\n   */\n  replaceState(state) {\n    this.state = state;\n\n    this.listeners.forEach((l) => l());\n  }\n\n  /**\n   * Get the current state of the store\n   * @return {object} the current store state\n   */\n  getState() {\n    return this.state;\n  }\n\n  /**\n   * Stub function to stay consistent with Redux Store API. No-op.\n   */\n  replaceReducer() {\n    return;\n  }\n\n  /**\n   * Dispatch an action to the background using messaging passing\n   * @param  {object} data The action data to dispatch\n   * @return {Promise}     Promise that will resolve/reject based on the action response from the background\n   */\n  dispatch(data) {\n    return new Promise((resolve, reject) => {\n      this.serializedMessageSender(\n        this.extensionId,\n        {\n          type: DISPATCH_TYPE,\n          portName: this.portName,\n          payload: data,\n        },\n        null,\n        (resp) => {\n          if (resp) {\n            const { error, value } = resp;\n\n            if (error) {\n              reject(new BackgroundError(error));\n            } else {\n              resolve(value && value.payload);\n            }\n          }\n        },\n      );\n    });\n  }\n\n  safetyHandler(message) {\n    if (message.action === 'storeReady' && message.portName === this.portName) {\n      // Remove Saftey Listener\n      this.browserAPI.runtime.onMessage.removeListener(this.safetyHandler);\n\n      // Resolve if readyPromise has not been resolved.\n      if (!this.readyResolved) {\n        this.readyResolved = true;\n        this.readyResolve();\n      }\n    }\n  }\n}\n\nexport const enhancedPromiseResponder = (dispatchResult, send) => {\n  Promise.resolve(dispatchResult)\n    .then((res) => {\n      send({\n        error: null,\n        value: res,\n      });\n    })\n    .catch((err) => {\n      console.error(err);\n      send({ error: err.message.message || err.message, value: null });\n    });\n};\n","import {\n  applyMiddleware,\n  compose as reduxCompose,\n  createStore as reduxCreateStore,\n} from 'redux';\nimport reduxThunk from 'redux-thunk';\nimport * as helpers from './helpers';\nimport createReducer from './create-reducer';\nimport extractDataFromModel from './extract-data-from-model';\nimport {\n  createPersistor,\n  createPersistMiddleware,\n  rehydrateStateFromPersistIfNeeded,\n} from './persistence';\nimport { createComputedPropertiesMiddleware } from './computed-properties';\nimport { createListenerMiddleware } from './listeners';\nimport { clone } from './lib';\nimport { createEffectsMiddleware } from './effects';\nimport { ProxyStore } from './proxy-store';\nimport { createAliasExecuterMiddleware } from './alias';\n\nexport function createStore(model, options = {}) {\n  const modelClone = clone(model);\n  const {\n    compose,\n    devTools = process.env.NODE_ENV !== 'production',\n    disableImmer = false,\n    enhancers = [],\n    initialState = {},\n    injections = {},\n    middleware = [],\n    mockActions = false,\n    name: storeName = `EasyPeasyStore`,\n    version = 0,\n    reducerEnhancer = (rootReducer) => rootReducer,\n    isProxyStore = false,\n    proxyStoreOptions = {},\n  } = options;\n\n  const bindReplaceState = (modelDef) => ({\n    ...modelDef,\n    ePRS: helpers.action((_, payload) => payload),\n  });\n\n  const _r = {};\n\n  let modeldef = bindReplaceState(modelClone);\n  let mockedActions = [];\n\n  const persistKey = (targetPath) =>\n    `[${storeName}][${version}]${\n      targetPath.length > 0 ? `[${targetPath.join('.')}]` : ''\n    }`;\n  const persistor = createPersistor(persistKey, _r);\n  const persistMiddleware = createPersistMiddleware(persistor, _r);\n\n  const replaceState = (nextState) => _r._i._aCD['@action.ePRS'](nextState);\n\n  const bindStoreInternals = (state = {}) => {\n    const data = extractDataFromModel(\n      modeldef,\n      state,\n      injections,\n      _r,\n      isProxyStore,\n    );\n    _r._i = {\n      ...data,\n      reducer: reducerEnhancer(\n        createReducer(disableImmer, data._aRD, data._cR, data._cP),\n      ),\n    };\n  };\n\n  const mockActionsMiddleware = () => () => (action) => {\n    if (action != null) {\n      mockedActions.push(action);\n    }\n    return undefined;\n  };\n\n  const composeEnhancers =\n    compose ||\n    (devTools &&\n    typeof window !== 'undefined' &&\n    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n      ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\n          name: storeName,\n        })\n      : reduxCompose);\n\n  bindStoreInternals(initialState);\n\n  const easyPeasyMiddleware = [\n    createComputedPropertiesMiddleware(_r),\n    ...middleware,\n  ];\n  if (!isProxyStore) {\n    easyPeasyMiddleware.push(createAliasExecuterMiddleware(_r));\n  }\n\n  easyPeasyMiddleware.push(\n    reduxThunk,\n    createListenerMiddleware(_r),\n    createEffectsMiddleware(_r),\n    persistMiddleware,\n  );\n\n  if (mockActions) {\n    easyPeasyMiddleware.push(mockActionsMiddleware);\n  }\n\n  let store;\n  if (isProxyStore) {\n    store = new ProxyStore(proxyStoreOptions);\n  } else {\n    store = reduxCreateStore(\n      _r._i.reducer,\n      _r._i._dS,\n      composeEnhancers(applyMiddleware(...easyPeasyMiddleware), ...enhancers),\n    );\n  }\n\n  store.subscribe(() => {\n    _r._i._cS.isInReducer = false;\n  });\n\n  _r.dispatch = store.dispatch;\n  _r.getState = store.getState;\n  _r.ready = store.ready;\n\n  const bindActionCreators = () => {\n    Object.keys(store.dispatch).forEach((actionsKey) => {\n      delete store.dispatch[actionsKey];\n    });\n    Object.keys(_r._i._aC).forEach((key) => {\n      store.dispatch[key] = _r._i._aC[key];\n    });\n  };\n\n  bindActionCreators();\n\n  const rebindStore = (removeKey) => {\n    const currentState = store.getState();\n    if (removeKey) {\n      delete currentState[removeKey];\n    }\n    bindStoreInternals(currentState);\n    store.replaceReducer(_r._i.reducer);\n    replaceState(_r._i._dS);\n    bindActionCreators();\n  };\n\n  const resolveRehydration = rehydrateStateFromPersistIfNeeded(\n    persistKey,\n    replaceState,\n    _r,\n  );\n\n  return Object.assign(store, {\n    addModel: (key, modelForKey) => {\n      if (modeldef[key] && process.env.NODE_ENV !== 'production') {\n        store.removeModel(key);\n      }\n      modeldef[key] = modelForKey;\n      rebindStore();\n      // There may have been persisted state for a dynamic model. We should try\n      // and rehydrate the specifc node\n      const addModelRehydration = rehydrateStateFromPersistIfNeeded(\n        persistKey,\n        replaceState,\n        _r,\n        key,\n      );\n      return {\n        resolveRehydration: () => addModelRehydration,\n      };\n    },\n    ready: _r.ready,\n    clearMockedActions: () => {\n      mockedActions = [];\n    },\n    getActions: () => _r._i._aC,\n    getListeners: () => _r._i._lAC,\n    getMockedActions: () => [...mockedActions],\n    persist: {\n      clear: persistor.clear,\n      flush: persistor.flush,\n      resolveRehydration: () => resolveRehydration,\n    },\n    reconfigure: (newModel) => {\n      modeldef = bindReplaceState(newModel);\n      rebindStore();\n    },\n    removeModel: (key) => {\n      if (!modeldef[key]) {\n        return;\n      }\n      delete modeldef[key];\n      rebindStore(key);\n    },\n  });\n}\n","/* eslint-disable react/prop-types */\n\nimport React, { createContext, useContext } from 'react';\nimport {\n  createStoreActionsHook,\n  createStoreDispatchHook,\n  createStoreStateHook,\n  createStoreRehydratedHook,\n} from './hooks';\nimport { createStore } from './create-store';\nimport { useMemoOne } from './lib';\n\nexport function createContextStore(model, config = {}) {\n  // We create a mutable injections reference to allow updating it\n  const { injections: mutableInjections = {} } = config;\n\n  const StoreContext = createContext();\n\n  function Provider({ children, runtimeModel, injections }) {\n    // If the user provided injections we need to ensure our mutable ref\n    // is up to date. We could consider doing a shallow compare here?\n    if (injections != null) {\n      const nextInjections =\n        typeof injections === 'function'\n          ? injections(mutableInjections)\n          : injections;\n      const nextKeys = Object.keys(nextInjections);\n      const removeKeys = Object.keys(mutableInjections).filter(\n        (k) => !nextKeys.includes(k),\n      );\n      removeKeys.forEach((k) => {\n        delete mutableInjections[k];\n      });\n      Object.assign(mutableInjections, nextInjections);\n    }\n\n    const store = useMemoOne(\n      () =>\n        createStore(typeof model === 'function' ? model(runtimeModel) : model, {\n          ...config,\n          originalInjections: mutableInjections,\n        }),\n      [],\n    );\n    return (\n      <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\n    );\n  }\n\n  function useStore() {\n    return useContext(StoreContext);\n  }\n\n  return {\n    Provider,\n    useStore,\n    useStoreState: createStoreStateHook(StoreContext),\n    useStoreActions: createStoreActionsHook(StoreContext),\n    useStoreDispatch: createStoreDispatchHook(StoreContext),\n    useStoreRehydrated: createStoreRehydratedHook(StoreContext),\n  };\n}\n","/**\n * This file has been copied from redux-persist.\n * The intention being to support as much of the redux-persist API as possible.\n */\n\nexport function createTransform(inbound, outbound, config = {}) {\n  const whitelist = config.whitelist || null;\n  const blacklist = config.blacklist || null;\n\n  function whitelistBlacklistCheck(key) {\n    if (whitelist && whitelist.indexOf(key) === -1) return true;\n    if (blacklist && blacklist.indexOf(key) !== -1) return true;\n    return false;\n  }\n\n  return {\n    in: (data, key, fullState) =>\n      !whitelistBlacklistCheck(key) && inbound\n        ? inbound(data, key, fullState)\n        : data,\n    out: (data, key, fullState) =>\n      !whitelistBlacklistCheck(key) && outbound\n        ? outbound(data, key, fullState)\n        : data,\n  };\n}\n","/* eslint-disable react/prop-types */\n\nimport React from 'react';\nimport StoreContext from './context';\n\nexport function StoreProvider({ children, store }) {\n  return (\n    <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\n  );\n}\n","import { useEffect, useRef, useState } from 'react';\nimport { useMemoOne } from './lib';\nimport { createStore } from './create-store';\n\nexport function useLocalStore(modelCreator, dependencies = [], configCreator) {\n  const storeRef = useRef();\n\n  const configRef = useRef();\n\n  const store = useMemoOne(() => {\n    const previousState =\n      storeRef.current != null ? storeRef.current.getState() : undefined;\n    const config =\n      configCreator != null\n        ? configCreator(previousState, configRef.current)\n        : undefined;\n    const _store = createStore(modelCreator(previousState), config);\n    configRef.current = config;\n    storeRef.current = _store;\n    return _store;\n  }, dependencies);\n\n  const [currentState, setCurrentState] = useState(() => store.getState());\n\n  useEffect(\n    () =>\n      store.subscribe(() => {\n        const nextState = store.getState();\n        if (currentState !== nextState) {\n          setCurrentState(nextState);\n        }\n      }),\n    [store],\n  );\n\n  return [currentState, store.getActions(), store];\n}\n"],"names":["StoreContext","createContext","useIsomorphicLayoutEffect","window","useLayoutEffect","useEffect","createStoreStateHook","Context","useStoreState","mapState","equalityFn","store","useContext","mapStateRef","useRef","stateRef","mountedRef","subscriptionMapStateError","useReducer","s","forceRender","current","undefined","getState","err","process","env","NODE_ENV","errorMessage","message","stack","Error","checkMapState","newState","isStateEqual","unsubscribe","subscribe","EasyPeasyContext","createStoreActionsHook","useStoreActions","mapActions","getActions","createStoreDispatchHook","useStoreDispatch","dispatch","useStore","createStoreRehydratedHook","useStoreRehydrated","useState","rehydrated","setRehydrated","persist","resolveRehydration","then","createTypedHooks","actionSymbol","actionOnSymbol","computedSymbol","effectOnSymbol","persistSymbol","reducerSymbol","thunkOnSymbol","thunkSymbol","aliasSymbol","debug","state","isDraft","actionOn","targetResolver","fn","action","defaultStateResolvers","computed","fnOrStateResolvers","stateResolvers","unstable_effectOn","dependencyResolvers","generic","value","model","config","thunkOn","thunk","alias","reducer","easyPeasyImmer","isPlainObject","obj","proto","Object","getPrototypeOf","clone","source","recursiveClone","next","keys","reduce","acc","key","getOwnPropertyDescriptor","get","forEach","isPromise","x","path","target","cur","newify","currentPath","currentState","finalValue","length","slice","set","idx","createSimpleProduce","disableImmer","simpleProduce","Immer","useProxies","Proxy","revocable","Reflect","autoFreeze","draft","createDraft","result","finishDraft","parentPath","parent","pReduce","iterable","initialValue","Promise","resolve","reject","iterator","Symbol","index","total","element","done","all","catch","pSeries","tasks","results","_","task","push","areInputsEqual","newInputs","lastInputs","i","useMemoOne","getResult","inputs","initial","React","committed","isInputMatch","Boolean","cache","createReducer","_aRD","_cR","_cP","runActionReducerAtPath","actionReducer","payload","reducerForActions","type","def","meta","reducerForCustomReducers","original","rootReducer","stateAfterActions","bindComputedProperty","parentState","noopStorage","getItem","setItem","removeItem","getBrowerStorage","storageName","storageCache","localStorage","sessionStorage","createStorageWrapper","storage","transformers","console","warn","outTransformers","reverse","serialize","data","in","JSON","stringify","deserialize","parse","out","isAsync","wrapped","extractPersistConfig","persistdef","allow","deny","mergeStrategy","resolvePersistTargets","targets","findIndex","createPersistenceClearer","persistKey","_r","_i","_persistenceConfig","map","createPersistor","persistPromise","isPersisting","nextPersistOperation","timingMethod","requestIdleCallback","requestAnimationFrame","nextState","operation","persistRootState","persistTargets","stateToPersist","targetPath","rawValue","finally","clear","flush","createPersistMiddleware","persistor","rehydrateStateFromPersistIfNeeded","replaceState","root","_dS","rehydrating","persistInstance","hasDataModelChanged","dataModel","rehydratingModelData","Array","isArray","applyRehydrationStrategy","persistedState","targetState","setAt","currentTargetState","currentPersistedState","rehydate","getItemResult","createActionCreator","actionCreator","resolvedTargets","createThunkHandler","injections","_aC","fail","helpers","getStoreActions","getStoreState","actionName","logThunkEventListenerError","log","handleEventDispatchErrors","dispatcher","createThunkActionsCreator","dispatchStart","startType","dispatchFail","failType","error","dispatchSuccess","successType","failure","_failure","thunkHandler","resolved","createAliasActionsCreator","isProxyStore","createAliasExecuterMiddleware","pathArray","split","shift","actions","aliasFunction","createListenerMiddleware","_lAM","sourceAction","_aCD","bindListenerdefs","listenerdefs","targetTypes","targetType","listenerReg","createComputedPropertyBinder","runOnce","prevInputs","prevValue","createComputedProperty","storeState","defineProperty","configurable","enumerable","resolver","_cS","isInReducer","match","createComputedPropertiesMiddleware","createEffectsMiddleware","_e","prevState","prevLocal","nextLocal","prevDependencies","nextDependencies","hasChanged","some","dependency","logEffectError","createEffectHandler","dispose","change","disposeResult","effectResult","logEffectEventListenerError","createEffectActionsCreator","effectHandler","previousDependencies","prev","extractDataFromModel","initialState","actionThunks","_lAC","recursiveExtractFromModel","handleValueAsState","initialParentRef","category","join","existing","sort","a","b","aPath","bPath","defaultOpts","portName","DEFAULT_PORT_NAME","extensionId","serializer","noop","deserializer","patchStrategy","shallowDiff","BackgroundError","name","ProxyStore","readyResolved","readyPromise","readyResolve","browserAPI","getBrowserAPI","port","runtime","connect","safetyHandler","bind","onMessage","safetyMessage","addListener","serializedPortListener","withDeserializer","serializedMessageSender","withSerializer","sendMessage","listeners","STATE_TYPE","PATCH_STATE_TYPE","patchState","ready","cb","listener","filter","l","difference","replaceReducer","DISPATCH_TYPE","resp","removeListener","enhancedPromiseResponder","dispatchResult","send","res","createStore","options","modelClone","compose","devTools","enhancers","middleware","mockActions","storeName","version","reducerEnhancer","proxyStoreOptions","bindReplaceState","modelDef","ePRS","modeldef","mockedActions","persistMiddleware","bindStoreInternals","mockActionsMiddleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","reduxCompose","easyPeasyMiddleware","reduxThunk","reduxCreateStore","applyMiddleware","bindActionCreators","actionsKey","rebindStore","removeKey","assign","addModel","modelForKey","removeModel","addModelRehydration","clearMockedActions","getListeners","getMockedActions","reconfigure","newModel","createContextStore","mutableInjections","Provider","children","runtimeModel","nextInjections","nextKeys","removeKeys","k","includes","originalInjections","createTransform","inbound","outbound","whitelist","blacklist","whitelistBlacklistCheck","indexOf","fullState","StoreProvider","useLocalStore","modelCreator","dependencies","configCreator","storeRef","configRef","previousState","_store","setCurrentState"],"mappings":"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"}